<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="css/create-eventstyle.css" />
    <script src="js/vue.js"></script>
    <script src="js/create-event.js"></script>
    <script src="js/element-index.js"></script>
    <script src="js/axios.min.js"></script>
    <title>Create Event Page</title>
</head>
<body>
<div  id="event">
    <div class="title">
        <el-col :span="24" style="padding-bottom: 20px">
            <div class="grid-content caption">CREATE EVENT</div>
        </el-col>
    </div>
    <el-row class="input-field">
        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Event ID</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <div class="grid-content input">
                    <el-input v-model="formData.id" placeholder="event ID"></el-input>
                </div>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Event Name</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <div class="grid-content input">
                    <el-input v-model="formData.title" placeholder="event name"></el-input>
                </div>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Date</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <div class="block">
                    <el-date-picker
                            v-model="formData.date"
                            type="date"
                            placeholder="Choose Date">
                    </el-date-picker>
                </div>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Time</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <el-time-select
                        class="el-time-select"
                        placeholder="startTime"
                        v-model="formData.startTime"
                        :picker-options="{
                            start: '08:30',
                            step: '00:15',
                            end: '23:30'
                        }">
                </el-time-select>
                <el-time-select
                        class="el-time-select"
                        placeholder="endTime"
                        v-model="formData.endTime"
                        :picker-options="{
                              start: '08:30',
                              step: '00:15',
                              end: '23:30',
                              minTime: formData.startTime
                            }">
                </el-time-select>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Room</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <el-select v-model="formData.room" clearable placeholder="please select">
                    <el-option
                            v-for="item in room"
                            :key="item.value"
                            :label="item.label"
                            :value="item.label">
                    </el-option>
                </el-select>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Tag</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <el-select v-model="formData.tag" clearable placeholder="please select">
                    <el-option
                            v-for="item in tag"
                            :key="item.value"
                            :label="item.label"
                            :value="item.label">
                    </el-option>
                </el-select>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Speaker</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <div class="grid-content input">
                    <el-input v-model="formData.speaker" placeholder="speaker"></el-input>
                </div>
            </div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content information">Responsible</div></el-col>
            <el-col :span="8" :offset="1"><div class="grid-content">
                <div class="grid-content input">
                    <el-input v-model="formData.responsible" placeholder="responsible"></el-input>
                </div>
            </div></el-col>
        </el-row>
    </el-row>

    <div class="form">
        <el-row :gutter="20">
            <el-col :span="4" :offset="6"><div class="grid-content operations">Operations:</div></el-col>
        </el-row>

        <el-row :gutter="20">
            <el-col :span="6"><div class="grid-content"></div></el-col>

            <el-table :data="formData.tableData" border style="width: 55%;">
                <el-table-column prop="type" label="Event Type" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.type" placeholder="Event type" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="staff" label="Support Staff" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.staff" placeholder="Support Staff" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="company" label="Company" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.company" placeholder="Company" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="contact" label="Contact" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.contact" placeholder="Contact" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="email" label="Contact Email" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.email" placeholder="Contact Email" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="location" label="Location" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.site" placeholder="Location" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="AV" label="AV" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.av" placeholder="AV" class="table"></el-input>
                    </template>
                </el-table-column>
                <el-table-column prop="notes" label="AV Notes" width="180">
                    <template slot-scope="scope">
                        <el-input v-model="scope.row.note" placeholder="AV Notes" class="table"></el-input>
                    </template>
                </el-table-column>
            </el-table>

        </el-row>
    </div>

    <div class="button">
    <el-button type="success" round @click="handleButtonClick">Create Event</el-button>
    </div>
</div>
</body>

<script>
    new Vue({
        el: '#event',
        data() {
            return {
                formData: {
                    id: '',
                    title: '',
                    date: '',
                    time: '',
                    speaker: '',
                    responsible: '',
                    tableData: [{
                        type: '',
                        staff: '',
                        company: '',
                        contact: '',
                        email: '',
                        location: '',
                        av: '',
                        note: ' '
                    }],
                },
                room: [{
                    value: 'option 1',
                    label: 'meeting room 1'
                }, {
                    value: 'option 2',
                    label: 'meeting room 2'
                }, {
                    value: 'option 3',
                    label: 'meeting room 3'
                }, {
                    value: 'option 4',
                    label: 'meeting room 4'
                }, {
                    value: 'option 5',
                    label: 'meeting room 5'
                }],
                tag: [{
                    value: 'option 1',
                    label: 'Technology'
                }, {
                    value: 'option 2',
                    label: 'Education'
                }, {
                    value: 'option 3',
                    label: 'Healthcare'
                }, {
                    value: 'option 4',
                    label: 'Finance'
                }, {
                    value: 'option 5',
                    label: 'Marketing'
                },
                {
                    value: 'option 6',
                    label: 'Real Estate'
                }],
            };
        },
        methods: {
            /*Converts the obtained date data into the desired date YYYY-MM-DD*/
            getFormattedDate(date) {
                const year = date.getFullYear();
                const month = date.getMonth() + 1;
                const day = date.getDate();
                return `${year}-${month.toString().padStart(2, '0')}-${day.toString().padStart(2, '0')}`;
            },
            handleButtonClick() {
                // this.goToHomePage();
                this.getFormData();
            },
            goToHomePage() {
                window.location.href = '/main.html';
            },
            getFormData() {
                const formattedDate = this.getFormattedDate(this.formData.date);
                const eventData = {
                    id: this.formData.id,
                    title: this.formData.title,
                    date: formattedDate,
                    time: this.formData.startTime + '-' + this.formData.endTime,
                    room: this.formData.room,
                    tag: this.formData.tag,
                    speaker: this.formData.speaker,
                    responsible: this.formData.responsible,
                    staff: this.formData.tableData[0].staff,
                    company: this.formData.tableData[0].company,
                    contact: this.formData.tableData[0].contact,
                    email: this.formData.tableData[0].email,
                    site: this.formData.tableData[0].site,
                    av: this.formData.tableData[0].av,
                    note: this.formData.tableData[0].note
                };
                console.log(eventData);
                axios.post('/api/event/create', eventData).then(response => {
                    console.log('Event created successfully', response);
                })
                    .catch(error => {
                        console.log('Error creating event', error);
                    });
            }
        }
    });
</script>
</html>